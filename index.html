
<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>心情小卡</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; background: #f0f4f8; }
    #moodCard { 
      margin-top: 20px; 
      border-radius: 10px; 
      padding: 20px; 
      max-width: 320px; 
      color: #fff; 
      display: none;
      box-shadow: 0 4px 8px rgba(0,0,0,0.2);
    }
    #downloadBtn { margin-top: 15px; }
    /* 背景顏色根據心情 */
    #moodCard.開心 { background: #4CAF50; }
    #moodCard.焦慮 { background: #FF9800; }
    #moodCard.疲憊 { background: #9E9E9E; }
    #moodCard.沮喪 { background: #F44336; }
  </style>
</head>
<body>

<h1>心情小卡</h1>

<label for="emailInput">Email（模擬登入）:</label><br />
<input type="email" id="emailInput" placeholder="example@gmail.com" style="width:250px;" /><br /><br />

<label for="moodSelect">選擇心情：</label><br />
<select id="moodSelect" style="width:150px;">
  <option value="開心">開心</option>
  <option value="焦慮">焦慮</option>
  <option value="疲憊">疲憊</option>
  <option value="沮喪">沮喪</option>
</select><br /><br />

<button id="generateBtn">產生心情卡片</button>

<div id="moodCard">
  <div id="moodText" style="font-size: 24px; font-weight: bold;"></div>
  <pre id="moodDesc" style="white-space: pre-wrap; font-size: 16px; margin-top:10px;"></pre>
</div>

<button id="downloadBtn" style="display:none;">下載小卡圖片</button>

<script>
  // 模擬登入帳號
  let currentUser = null;

  // 多句心情描述
  const moodDescriptions = {
    "開心": [
      "今天的你充滿陽光與正能量，繼續保持這份好心情吧！",
      "笑容是你最美的裝飾，讓快樂感染更多人吧！",
      "這世界因你而更美好，保持這份光芒！"
    ],
    "焦慮": [
      "可能事情有點多，別忘了深呼吸、喝杯水，慢慢來。",
      "感到不安是正常的，請給自己一點空間。",
      "即使現在心亂如麻，你依然值得溫柔以待。"
    ],
    "疲憊": [
      "辛苦了，適時放鬆是對自己的愛護。",
      "累了就好好休息，明天會更好。",
      "給自己充電的時間，不要太苛求自己。"
    ],
    "沮喪": [
      "黑暗過後，陽光總會來臨。",
      "失落是暫時的，請相信自己的力量。",
      "允許自己難過，但別放棄希望。"
    ]
  };

  // Emoji 對應
  const moodEmojis = {
    "開心": "😊",
    "焦慮": "😰",
    "疲憊": "😩",
    "沮喪": "😞"
  };

  const emailInput = document.getElementById('emailInput');
  const moodSelect = document.getElementById('moodSelect');
  const generateBtn = document.getElementById('generateBtn');
  const moodCard = document.getElementById('moodCard');
  const moodText = document.getElementById('moodText');
  const moodDesc = document.getElementById('moodDesc');
  const downloadBtn = document.getElementById('downloadBtn');

  function generateCard() {
    currentUser = emailInput.value.trim() || null;
    const mood = moodSelect.value;
    const date = new Date().toLocaleDateString();

    // 隨機挑一句描述
    const messages = moodDescriptions[mood];
    const randomMessage = messages[Math.floor(Math.random() * messages.length)];

    const emoji = moodEmojis[mood];
    const userText = currentUser ? `👤 使用者：${currentUser}` : '👤 尚未登入';

    // 顯示卡片內容
    moodText.innerText = `${emoji} 心情：${mood}`;
    moodDesc.innerText = `${randomMessage}\n\n${userText}\n📅 日期：${date}`;

    // 設定卡片背景色（class）
    moodCard.className = '';
    moodCard.classList.add(mood);
    moodCard.style.display = 'block';

    downloadBtn.style.display = 'inline-block';
  }

  function downloadCard() {
    // 建立 canvas，將卡片內容畫上去
    const canvas = document.createElement('canvas');
    canvas.width = 400;
    canvas.height = 300;
    const ctx = canvas.getContext('2d');

    // 背景顏色依心情改變
    const bgColors = {
      "開心": "#4CAF50",
      "焦慮": "#FF9800",
      "疲憊": "#9E9E9E",
      "沮喪": "#F44336"
    };
    const mood = moodSelect.value;
    ctx.fillStyle = bgColors[mood] || '#333';
    ctx.fillRect(0, 0, canvas.width, canvas.height);

    // 文字設定
    ctx.fillStyle = '#fff';
    ctx.font = '28px sans-serif';
    ctx.fillText(moodText.innerText, 20, 60);

    ctx.font = '18px sans-serif';
    const lines = moodDesc.innerText.split('\n');
    for (let i = 0; i < lines.length; i++) {
      ctx.fillText(lines[i], 20, 100 + i * 30);
    }

    // 產生下載連結
    const link = document.createElement('a');
    link.download = `心情小卡_${mood}_${new Date().toISOString().slice(0,10)}.png`;
    link.href = canvas.toDataURL('image/png');
    link.click();
  }

  generateBtn.addEventListener('click', generateCard);
  downloadBtn.addEventListener('click', downloadCard);
</script>

</body>
</html>

    updateHistory();
    updateChart();
  </script>
</body>
</html>
